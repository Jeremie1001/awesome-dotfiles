// w2 inlined with fallback